# Prometheus configuration for Rigbeat
#
# This configuration is optimized for real-time hardware monitoring
# with fast scrape intervals and appropriate timeouts for gaming PCs.
#
# Usage:
#   1. Save as prometheus.yml
#   2. Place in your Prometheus config directory
#   3. Start Prometheus with: prometheus --config.file=prometheus.yml

global:
  scrape_interval: 2s      # Fast updates for real-time monitoring
  evaluation_interval: 15s
  external_labels:
    monitor: 'rigbeat-gaming-pc'

# Alertmanager configuration (optional)
# Uncomment and configure if you want hardware alerts
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           - localhost:9093

# Load rules once and periodically evaluate them
# Uncomment and create alerts.yml for hardware temperature/fan alerts
# rule_files:
#   - "alerts.yml"

scrape_configs:
  # Rigbeat Hardware Monitor
  - job_name: 'rigbeat-hardware'
    scrape_interval: 2s
    scrape_timeout: 10s
    metrics_path: '/metrics'
    static_configs:
      - targets: ['localhost:9182']
        labels:
          instance: 'gaming-pc'
          environment: 'home'
          service: 'rigbeat'
    # Optional: Add relabeling to clean up metric names or add custom labels
    # metric_relabel_configs:
    #   - source_labels: [__name__]
    #     regex: 'rigbeat_(.*)'
    #     target_label: __name__
    #     replacement: 'hw_${1}'

  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
        labels:
          service: 'prometheus'

# Example alert rules (create alerts.yml file):
#
# groups:
#   - name: hardware_alerts
#     rules:
#       - alert: HighCPUTemp
#         expr: rigbeat_cpu_temperature_celsius > 80
#         for: 30s
#         labels:
#           severity: warning
#         annotations:
#           summary: "CPU temperature is high"
#           description: "CPU temperature is {{ $value }}°C on {{ $labels.instance }}"
#
#       - alert: HighGPUTemp
#         expr: rigbeat_gpu_temperature_celsius > 85
#         for: 30s
#         labels:
#           severity: warning
#         annotations:
#           summary: "GPU temperature is high"
#           description: "GPU temperature is {{ $value }}°C on {{ $labels.instance }}"
#
#       - alert: FanStopped
#         expr: rigbeat_fan_speed_rpm < 200
#         for: 60s
#         labels:
#           severity: critical
#         annotations:
#           summary: "Fan may have stopped"
#           description: "{{ $labels.fan }} ({{ $labels.type }}) is running at {{ $value }} RPM"
#
#       - alert: RigbeatDown
#         expr: up{job="rigbeat-hardware"} == 0
#         for: 30s
#         labels:
#           severity: critical
#         annotations:
#           summary: "Rigbeat service is down"
#           description: "Hardware monitoring service is not responding"
